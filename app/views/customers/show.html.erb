<h1 class="text-3xl text-gray-700">顧客情報詳細</h1>
<div class="mt-3 w-full flex" style="justify-content: end">
  <%=
    link_to @customer.name + " 様の画像一覧",
    edit_customer_path(@customer),
    class: "flex justify-center content-center py-3 px-4 inline-flex items-center gap-x-2 text-sm font-semibold rounded-lg border border-transparent bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50 disabled:pointer-events-none dark:focus:outline-none dark:focus:ring-1 dark:focus:ring-gray-600"
  %>
</div>

<div class="py-8">
  <div class="flex flex-col bg-white border rounded shadow-md py-20">
    <div class="flex justify-center">
      <div class="w-3/12">
        <div class="flex flex-col pb-8">
          <p class="text-sm font-medium mb-2">顧客名</p>
          <p class="text-center py-3 border block w-full border-gray-300 rounded text-sm">
            <%= @customer.name %>
          </p>
        </div>
        <div class="flex flex-col pb-8">
          <p class="text-sm font-medium mb-2">電話番号</p>
          <p class="text-center py-3 border block w-full border-gray-300 rounded text-sm">
            <%= @customer.phone_number %>
          </p>
        </div>
        <div class="flex flex-col pb-8">
          <p class="text-sm font-medium mb-2">備考</p>
          <p class="text-center py-10 border block w-full border-gray-300 rounded text-sm">
            <%= @customer.remarks %>
          </p>
        </div>
      </div>
    </div>
    <div class="flex justify-center mt-10 space-x-2">
      <%=
        link_to "編集",
        edit_customer_path(@customer),
        class: "flex justify-center content-center py-3 px-4 inline-flex items-center gap-x-2 text-sm font-semibold rounded-lg border border-transparent bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50 disabled:pointer-events-none dark:focus:outline-none dark:focus:ring-1 dark:focus:ring-gray-600",
        style: "width: 100px;"
      %>
      <%=
        link_to "削除",
        customer_path(@customer),
        data: { turbo_method: :delete, turbo_confirm: '本当に削除しますか?' },
        class: "flex justify-center content-center py-3 px-4 inline-flex items-center gap-x-2 text-sm font-semibold rounded-lg border border-transparent bg-red-900 text-white hover:bg-red-800 disabled:opacity-50 disabled:pointer-events-none dark:focus:outline-none dark:focus:ring-1 dark:focus:ring-gray-600",
        style: "width: 100px;"
      %>
    </div>
    <div class="flex justify-center mt-8">
      <%= link_to "戻る", customers_path, class: "text-gray-700 hover:text-gray-500" %>
    </div>
  </div>
  <div class="pt-20 flex flex-col">
    <div class="w-full flex" style="justify-content: space-between; align-items: center; margin-bottom: 15px;">
      <h2 class="text-2xl text-gray-700 pb-6">来店履歴</h2>
      <%=
        link_to @customer.name + " 様の来店履歴作成",
        new_customer_visit_history_path(customer_id: @customer.id),
        class: "flex justify-center content-center py-3 px-4 inline-flex items-center gap-x-2 text-sm font-semibold rounded-lg border border-transparent bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50 disabled:pointer-events-none dark:focus:outline-none dark:focus:ring-1 dark:focus:ring-gray-600"
      %>
    </div>

    <div class="flex flex-col justify-center bg-white border rounded shadow-md p-20 space-y-5">
      <% if @customer_visit_history %>
        <div class="flex space-x-5">
          <div class="flex items-center space-x-1 text-gray-700 hover:text-gray-500">
            <svg class="flex-shrink-0 w-5 h-5" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99" /></svg>
            <%= sort_link(@q, :updated_at, "更新日順") %>
          </div>
          <div class="flex items-center space-x-1 text-gray-700 hover:text-gray-500">
            <svg class="flex-shrink-0 w-5 h-5" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
            <%= sort_link(@q, :created_at, "作成日時順") %>
          </div>
        </div>
        <div class="grid grid-cols-4 gap-4">
          <% @customer_visit_histories.each do |customer_visit_history| %>
            <div class="flex flex-col bg-white border border-gray-300 py-5 my-2 hover:bg-gray-50">
              <div class="flex justify-center items-center text-gray-800">
                <p class="font-semibold text-gray-600">
                  <%= I18n.l customer_visit_history.visit_datetime, format: :long %>
                </p>
              </div>
              <div class="flex-1 my-10">
                <% customer_visit_history.selected_menu_snapshots.sort_by(&:name_at_time).each do |selected_menu_snapshot| %>
                  <li class="flex justify-center space-x-10 text-sm text-gray-800">
                    <p><%= selected_menu_snapshot.name_at_time %></p>
                    <p><%= selected_menu_snapshot.price_at_time %>円</p>
                  </li>
                <% end %>
              </div>
              <div class="flex justify-center space-x-2 items-center">
                <%=
                  link_to '編集',
                  edit_customer_visit_history_path(customer_visit_history.id),
                  class: "flex justify-center content-center py-3 px-4 inline-flex items-center gap-x-2 text-sm font-semibold rounded-lg border border-transparent bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50 disabled:pointer-events-none dark:focus:outline-none dark:focus:ring-1 dark:focus:ring-gray-600"
                %>
                <%=
                  link_to '削除',
                  customer_visit_history_path(customer_visit_history.id),
                  data: { turbo_method: :delete, turbo_confirm: '本当に削除しますか?' },
                  class: "flex justify-center content-center py-3 px-4 inline-flex items-center gap-x-2 text-sm font-semibold rounded-lg border border-transparent bg-red-900 text-white hover:bg-red-800 disabled:opacity-50 disabled:pointer-events-none dark:focus:outline-none dark:focus:ring-1 dark:focus:ring-gray-600"
                %>
              </div>
            </div>
          <% end %>
        </div>
      <% else %>
        <p class="text-center text-gray-700">来店履歴はありません</p>
      <% end %>
    </div>
  </div>
</div>